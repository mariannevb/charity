* ikea_namegroup_example
* illustrate difference between family and variety
* show that
* (1) variety prices conditional on 'good' move in lockstep,
* (2) but goods within family do not
* menu cost/page layout?
* ------------------------------------------------------------------------------
* Initialize
clear all
cd "/Users/xu/Dropbox/XU/03 GD/20 BU/baxter/xu/charity"

use "./data/ikea_fill_2018.dta", replace
drop if flag > 0

* ------------------------------------------------------------------------------
* the variable "j" is the variety , e.g., color;
* j is numeric but has a label that is the text describing the color
* I wanted to be able to refer to the variable j using the color
* so I created "v_name" (variety name), now we can to refer to varieties by number or by v_name
* v_name creates a variable that is the name of the variety
quietly do "$PROGDIR\ikea_namegroup.do"
quietly do "$PROGDIR\v_name.do"

* ------------------------------------------------------------------------------
* billy in us
keep if c=="us" & name=="billy"

sort ijc y
bysort ijc: gen lagpricef=L1.pricef
la var lagpricef "lagged price"

sort ijc y
bysort ijc: gen dpf=float(pricef)-float(lagpricef)
replace dpf=round(dpf,0.01)
la var dpf "level change"

* throughout the programs, "i" denotes a unique good, and "j" denotes a variety
* all goods with the same "i" should have the same name, dimensions, and description
* a "variety" is a good's finish, e.g., white, black, oak, for bookcases;
* leather or cloth for chairs

egen good=group(name g1 g2 g3)

gen dims=string(g1)+"_"+string(g2)+"_"+string(g3)
la var dims "dimension string"

* ------------------------------------------------------------------------------
* here is an example. notice that
* The wood-finish bookcases cost $39.99 in 2006-2008 but rose to $49.99 in 2009-2011.
* The white bookcases cost $19.99 in 2006-2007 but rose to $24.99 in 2008-2011
* The point of this example is that
* the wood-finish bookcases had the same price and moved together
* The white bookcase had a different (lower) price and changed at a different time

sort i y j
* "i" of interest 1377, 1384, 1401, 1406, 1424, 1440 (freq >= 20)

table y j if i==1377, c(mean pricef)
* ---------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown          oak        white
* ---------+-----------------------------------------------------------------------------
*     2006 |          39           39           39           39           39           19
*     2007 |          39           39           39           39                        19
*     2008 |          39           39           39           39                      # 24
*     2009 |        @ 49         @ 49         @ 49         @ 49                        24
*     2010 |                       49           49           49                        24
*     2011 |                       49           49           49                        24
*----------------------------------------------------------------------------------------

table y j if i==1384, c(mean pricef)
*----------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown          oak        white
*----------+-----------------------------------------------------------------------------
*     2005 |          59           59           59                        59           39
*     2006 |          59           59           59           59           59           39
*     2007 |          59           59           59           59                        29
*     2008 |         @59          @59          @59          @59                       #34
*     2009 |          69           69           69           69                        34
*     2010 |                       69           69           69                        34
*     2011 |                      @59          @59          @59                        34
*----------------------------------------------------------------------------------------

table y j if i==1401, c(mean pricef)
*----------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown          oak        white
*----------+-----------------------------------------------------------------------------
*     2006 |          59           59           59           59           59           39
*     2007 |          59           59           59           59                        29
*     2008 |          59           59           59           59                      # 34
*     2009 |        @ 69         @ 69         @ 69         @ 69                        34
*     2010 |                       69           69           69                        34
*     2011 |                                  @ 59         @ 59                        34
*     2012 |                                                                           34
*     2013 |                                                                         # 39
*----------------------------------------------------------------------------------------

table y j if i==1406, c(mean pricef)
* --------------------------------------------------------------------------------------------------
*   year |  beech  birch  black  black-brown   blue  brown  gray  green    oak    red  silver  white
* -------+------------------------------------------------------------------------------------------
*   2005 |     79     79                  79                  59            79                    59
*   2006 |     79     79                  79            79                  79                    59
*   2007 |     79     79     59           79            79           59            59      59   # 49
*   2008 |     79     79     59           79            79                         59      59   # 59
*   2009 |   @ 89   @ 89     59         @ 89          @ 89                         59      59     59
*   2010 |            89     59           89     59     89                         59      59     59
*   2011 |          @ 69   @ 59         @ 69     59   @ 69                         59      59     59
*   2012 |          @ 79                @ 79          @ 79                                      # 49
*   2013 |                                79                                                      49
*   2014 |                                79                                                    # 59
* --------------------------------------------------------------------------------------------------

table y j if i==1424, c(mean pricef)
* ----------------------------------------------------------------------------------------
*      year |       beech        birch  black-brown        brown          oak        white
* ----------+-----------------------------------------------------------------------------
*      2006 |          15           15           15           15           15           10
*      2007 |          15           15           15           15                        10
*      2008 |          15           15           15           15                        10
*      2009 |        @ 20         @ 20         @ 20         @ 20                        10
*      2010 |                       20           20           20                        10
*      2011 |                       20           20           20                      # 15
* ----------------------------------------------------------------------------------------

table y j if i==1440, c(mean pricef)
* ----------------------------------------------------------------------------------------
*      year |       beech        birch  black-brown        brown          oak        white
* ----------+-----------------------------------------------------------------------------
*      2005 |          25           25           25                        25           20
*      2006 |          25           25           25           25           25           20
*      2007 |          25           25           25           25                        20
*      2008 |          25           25           25           25                        20
*      2009 |        @ 30         @ 30         @ 30         @ 30                        20
*      2010 |                       30           30           30                        20
*      2011 |                       30           30           30                        20
* ----------------------------------------------------------------------------------------

*------------------------------------------------------------------------------
* note: for the dims value "106_40_28" there is an entry in "white" in 2011 that costs much more,
* this must be a different good.... it was given a different "i" from the other white units
* so this is an illustrative example; to do this carefully I'd need to check why the gray units have different i
* codes from white and also check for other solid colors that I'm not catching here, but this should give you an idea

sort dims y j
* "dims" of interest 106_40_28, 106_80_28, 202_40_28, 202_80_28, 40_35_28, 80_35_28 (freq >= 20)

table y j if dims=="106_40_28", c(mean pricef)
*----------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown          oak        white
*----------+-----------------------------------------------------------------------------
*     2006 |          39           39           39           39           39           19
*     2007 |          39           39           39           39                        19
*     2008 |          39           39           39           39                       #24
*     2009 |         @49          @49          @49          @49                        24
*     2010 |                       49           49           49                        24
*     2011 |                       49           49           49                       #42
*----------------------------------------------------------------------------------------

table y j if dims=="106_80_28", c(mean pricef)
*-----------------------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown         gray          oak        white
*----------+------------------------------------------------------------------------------------------
*     2005 |          59           59           59                        39           59           39
*     2006 |          59           59           59           59                        59           39
*     2007 |          59           59           59           59                                    #29
*     2008 |          59           59           59           59                                     34
*     2009 |         @69          @69          @69          @69                                    695
*     2010 |                       69           69           69                                     34
*     2011 |                      @59          @59          @59                                     34
*-----------------------------------------------------------------------------------------------------

table y j if dims=="202_40_28", c(mean pricef)
*----------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown          oak        white
*----------+-----------------------------------------------------------------------------
*     2006 |          59           59           59           59           59           39
*     2007 |          59           59           59           59                        29
*     2008 |          59           59           59           59                       #34
*     2009 |         @69          @69          @69          @69                        34
*     2010 |                       69           69           69                        34
*     2011 |                                   @59          @59                        34
*     2013 |                                                                          #39
*----------------------------------------------------------------------------------------

table y j if dims=="202_80_28", c(mean pricef)

*------------------------------------------------------------------------------------------
* year |  beech  birch  black black-brown  blue  brown  gray green  oak  red  silver  white
*------+-----------------------------------------------------------------------------------
* 2005 |     79     79                 79                 59         79                  59
* 2006 |     79     79                 79           79               79                  59
* 2007 |     79     79     59          79           79          59        59      59    #49
* 2008 |     79     79     59          79           79                    59      59    #59
* 2009 |    @89    @89     59         @89          @89                    59             59
* 2010 |            89     59          89    59     89                    59             59
* 2011 |           @69     59         @69    59    @69                    59      59
* 2012 |           @79                @79          @79                                  #49
* 2014 |                               79                                                59
*------------------------------------------------------------------------------------------

table y j if dims=="40_35_28" , c(mean pricef)
*----------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown          oak        white
*----------+-----------------------------------------------------------------------------
*     2006 |          15           15           15           15           15           10
*     2007 |          15           15           15           15                        10
*     2008 |          15           15           15           15                        10
*     2009 |         @20          @20          @20          @20                        10
*     2010 |                       20           20           20                        10
*     2011 |                       20           20           20                       #15
*----------------------------------------------------------------------------------------

table y j if dims=="80_35_28" , c(mean pricef)
*-----------------------------------------------------------------------------------------------------
*     year |       beech        birch  black-brown        brown         gray          oak        white
*----------+------------------------------------------------------------------------------------------
*     2005 |          25           25           25                        20           25           20
*     2006 |          25           25           25           25                        25           20
*     2007 |          25           25           25           25                                     20
*     2008 |          25           25           25           25                                     20
*     2009 |         @30          @30          @30          @30                                     20
*     2010 |                       30           30           30                                     20
*     2011 |                       30           30           30                                     20
*-----------------------------------------------------------------------------------------------------

*------------------------------------------------------------------------------
* is white special?

* (1) lower price
* (2) lead price change (pc indicator) with about same percentage change (pc level)

